-- Table UTILISATEUR
CREATE TABLE UTILISATEUR (
  IDUTILISATEUR INT NOT NULL PRIMARY KEY GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
  NOM VARCHAR(45) NOT NULL,
  PRENOM VARCHAR(45) NOT NULL,
  DATENAISSANCE DATE NOT NULL,
  EMAIL VARCHAR(45) NOT NULL,
  MOBILE VARCHAR(45) NOT NULL,
  estConducteur BOOLEAN
);

-- Table CONDUCTEUR
CREATE TABLE CONDUCTEUR (
  IDCONDUCTEUR INT NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
  EMPLOYEUR VARCHAR(45) NOT NULL,
  IDUTILISATEUR INT NOT NULL,
  PRIMARY KEY (IDCONDUCTEUR),
  CONSTRAINT CONDUCTEUR_UTILISATEUR_fk
    FOREIGN KEY (IDUTILISATEUR)
    REFERENCES UTILISATEUR (IDUTILISATEUR)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

-- Table PASSAGER
CREATE TABLE PASSAGER (
  IDPASSAGER INT NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
  IDUTILISATEUR INT NOT NULL,
  PRIMARY KEY (IDPASSAGER),
  CONSTRAINT PASSAGER_UTILISATEUR_fk
    FOREIGN KEY (IDUTILISATEUR)
    REFERENCES UTILISATEUR (IDUTILISATEUR)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

-- Table TRAJET
CREATE TABLE TRAJET (
  IDTRAJET INT NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
  HEURERDV TIME NOT NULL,
  ADRESSERDV VARCHAR(45) NOT NULL,
  DATERDV DATE NOT NULL,
  ADRESSEFIN VARCHAR(45) NOT NULL,
  NBPASSAGER INT NOT NULL,
  ACTIVER BOOLEAN NOT NULL,
  IDCONDUCTEUR INT NOT NULL,
  PRIMARY KEY (IDTRAJET),
  CONSTRAINT TRAJET_CONDUCTEUR_fk
    FOREIGN KEY (IDCONDUCTEUR)
    REFERENCES CONDUCTEUR (IDCONDUCTEUR)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

-- Table VOYAGE
CREATE TABLE VOYAGE (
  IDVOYAGE INT NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
  NBVOYAGEUR INT NOT NULL,
  IDTRAJET INT NOT NULL,
  IDCONDUCTEUR INT NOT NULL,
  PRIMARY KEY (IDVOYAGE),
  CONSTRAINT VOYAGE_TRAJET_fk
    FOREIGN KEY (IDTRAJET)
    REFERENCES TRAJET (IDTRAJET)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

-- Table EVALUATIONCONDUCTEUR
CREATE TABLE EVALUATIONCONDUCTEUR (
  IDEVALUATIONCONDUCTEUR INT NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
  NOTE INT NOT NULL,
  COMMENTAIRE VARCHAR(255) NOT NULL,
  IDVOYAGE INT NOT NULL,
  PRIMARY KEY (IDEVALUATIONCONDUCTEUR),
  CONSTRAINT EVALUATIONCONDUCTEUR_VOYAGE_fk
    FOREIGN KEY (IDVOYAGE)
    REFERENCES VOYAGE (IDVOYAGE)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

-- Table EVALUATIONPASAGER
CREATE TABLE EVALUATIONPASAGER (
  IDEVALUATIONPASAGER INT NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
  NOTE INT NOT NULL,
  COMMENTAIRE VARCHAR(255) NOT NULL,
  IDVOYAGE INT NOT NULL,
  PRIMARY KEY (IDEVALUATIONPASAGER),
  CONSTRAINT EVALUATIONPASAGER_VOYAGE_fk
    FOREIGN KEY (IDVOYAGE)
    REFERENCES VOYAGE (IDVOYAGE)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

-- Table VOYAGE_has_PASSAGER
CREATE TABLE VOYAGE_has_PASSAGER (
  IDVOYAGE INT NOT NULL,
  IDPASSAGER INT NOT NULL,
  PRIMARY KEY (IDVOYAGE, IDPASSAGER),
  CONSTRAINT VOYAGE_has_PASSAGER_VOYAGE_fk
    FOREIGN KEY (IDVOYAGE)
    REFERENCES VOYAGE (IDVOYAGE)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT VOYAGE_has_PASSAGER_PASSAGER_fk
    FOREIGN KEY (IDPASSAGER)
    REFERENCES PASSAGER (IDPASSAGER)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);
